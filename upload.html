<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Upload Music | Truly Yours DSP</title>

<style>
body { background:#050008; color:white; font-family:Arial,sans-serif; margin:0; padding:0; }
.navbar { background:#111; padding:15px; display:flex; gap:20px; }
.navbar a { color:white; text-decoration:none; font-weight:bold; }
.container { max-width:700px; margin:80px auto; background:#1113; padding:30px; border-radius:12px; }
input, button { width:100%; padding:12px; margin-top:10px; }
button { cursor:pointer; background:#ff2bd1; border:none; font-weight:bold; }
.status { font-size:18px; margin-top:10px; }
</style>
</head>

<body>

<div class="navbar">
  <a href="index.html">HOME</a>
  <a href="dashboard.html">DASHBOARD</a>
</div>

<div class="container">
  <h1>Upload Your Music</h1>

  <input type="file" id="musicFile" accept=".mp3">
  <button onclick="uploadSong()">UPLOAD SONG</button>
  <div id="uploadStatus" class="status">Waiting...</div>
</div>


<!-- ========== UPLOAD SCRIPT ========== -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-app.js";
import { 
  getStorage, ref, uploadBytesResumable, getDownloadURL 
} from "https://www.gstatic.com/firebasejs/10.8.1/firebase-storage.js";

const firebaseConfig = {
  apiKey: "AIzaSy....",
  authDomain: "truly-yours-dsp-2025.firebaseapp.com",
  projectId: "truly-yours-dsp-2025",
  storageBucket: "truly-yours-dsp-2025.appspot.com", // << FIXED
  messagingSenderId: "3690...",
  appId: "1:3690...."
};

const app = initializeApp(firebaseConfig);
const storage = getStorage(app);

window.uploadSong = () => {
  const choose = document.getElementById("musicFile");
  const status = document.getElementById("uploadStatus");

  if (!choose.files.length) { status.innerText="Pick a file first"; return; }

  const file = choose.files[0];
  const filename = Date.now()+"-"+file.name;
  const path = ref(storage, "artists_audio/"+filename);

  const upload = uploadBytesResumable(path, file);

  upload.on("state_changed",
    (snap)=>{
      const pct = Math.round((snap.bytesTransferred/snap.totalBytes)*100);
      status.innerText = `Uploading... ${pct}%`;
    },
    (err)=>status.innerText="❌ "+err.message,
    async ()=>{
      status.innerText="✅ Upload complete!";
    }
  );
};
</script>

</body>
</html>
