<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Artist Dashboard | Truly Yours DSP</title>

<style>
body { background:#050008; color:white; font-family:Arial,sans-serif; margin:0; }
.navbar { background:#111; padding:15px; display:flex; gap:20px; }
.navbar a { color:white; text-decoration:none; font-weight:bold; }
.container { max-width:700px; margin:50px auto; padding:30px; }
button { padding:8px 12px; margin-top:5px; margin-bottom:10px; background:#ff2bd1; border:none; border-radius:6px; cursor:pointer; }
</style>
</head>

<body>

<div class="navbar">
  <a href="index.html">HOME</a>
  <a href="upload.html">UPLOAD</a>
</div>

<div class="container">
  <h1>Your Songs ðŸŽ§</h1>
  <ul id="songList">Loadingâ€¦</ul>
</div>


<!-- ========== LOAD SONGS SCRIPT ========== -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-app.js";
import { 
  getStorage, ref, listAll, getDownloadURL 
} from "https://www.gstatic.com/firebasejs/10.8.1/firebase-storage.js";

const firebaseConfig = {
  apiKey: "AIzaSy....",
  authDomain: "truly-yours-dsp-2025.firebaseapp.com",
  projectId: "truly-yours-dsp-2025",
  storageBucket: "truly-yours-dsp-2025.appspot.com", // << FIXED
  messagingSenderId: "3690...",
  appId: "1:3690...."
};

const app = initializeApp(firebaseConfig);
const storage = getStorage(app);
const songList = document.getElementById("songList");

async function loadSongs(){
  songList.innerText="Loadingâ€¦ ðŸ”„";
  const folder = ref(storage, "artists_audio/");
  const files = await listAll(folder);

  if (!files.items.length){
    songList.innerHTML="<li>No songs yet â€” upload one ðŸ”¥</li>";
    return;
  }

  songList.innerHTML="";
  for (const fileRef of files.items){
    const url = await getDownloadURL(fileRef);
    const name = fileRef.name.replace(/^\d+-/, ""); // remove timestamp

    const li = document.createElement("li");
    li.innerHTML = `
      ðŸŽµ <strong>${name}</strong><br>
      <audio controls src="${url}" style="margin-top:6px;"></audio>
    `;
    songList.appendChild(li);
  }
}

loadSongs();
</script>

</body>
</html>
